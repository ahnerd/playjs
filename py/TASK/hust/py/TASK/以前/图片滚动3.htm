<html>
<head>
<style>
body{margin:0px;}
ul{list-style:none; border:0; padding:0px; margin:0px;}
li{list-style:none; float:left; border:0; padding:0px; margin:0px;}
img{border:0px;  padding:0px; margin:0px;}
</style>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312"></head>
<body>
<!--<center><div id="div1" style="overflow:hidden; cursor:hand; margin-top:50px;">
           <ul id="div1_c" style="clear:both;">
              <li><img id="img0" src="do.dif" width="100" height="100" style="display:block;" /></li>
     <li><img id="img1" src="do.dif" width="100" height="100" style="display:block;" /></li>
     <li><img id="img2" src="do.dif" width="100" height="100" style="display:block;" /></li>
     <li><img id="img3" src="do.dif" width="100" height="100" style="display:block;" /></li>
        </ul>     
</div>-->

<script language="javascript">


var marquee = [];
marquee.creat = function(){
	var A = arguments?arguments[0]:{};
						document.getElementById("fh").value+="s";
	if(marquee.length){
		var i=marquee.length++-1;
		document.getElementById("fh").value+=arguments[1] + A.id || ("div"+ i ) ;
		if(!arguments[1]){
			marquees=new Array();
			window.marquees[i]=[];
			window.marquees[i].creat=marquee.creat;
			window.marquees[i].begin=marquee.begin;
			window.marquees[i].stop=marquee.stop;
			window.marquees[i].creat(A,1);
			return window.marquees[i];
    	}else{
			document.getElementById("fh").value+=this.construction
		}
	}else{marquee.length=1}
	document.getElementById("fh").value+="cr";
	this.width = A.width || 400;         //宽
	this.height  = A.height || 100;        //高
	this.id = A.id || "div1";  //id
	this.direction = A.direction || "left";   //-------滚动方向有四个值left，right，up，down，自己试试--------//
	this.speed = A.speed || 100 ;//-------滚动速度100相当于1秒，越小越快--------//
	this.cid = marquee.id +"_c";//-------放图片的容器id--------//
	var sHTML="";
	var sCSS = ".marquee{overflow:hidden; cursor:pointer; margin-top:50px;}\n\t.marquee li{list-style:none; float:left; border:0; padding:0px; margin:0px;}\n\t.marquee img{border:0px;  padding:0px; margin:0px;display:block;}\n";
	if( A.CSS)
		sCSS+=".marquee{" + A.CSS + "}\n";
	var HTML=1;    //使用<img>  和   <img />
	
	if(A.img){
		HTML=HTML?"></li>\n":" /></li>\n";
		for(var i=0;i<A.img.length;i++){
			sHTML+="\t\t<li><img";
			for(attr in A.img[i])
				sHTML+=" "+attr + "='"+ A.img[i][attr] + "'";
			sHTML+=HTML;
			
		}
		
	}else if(A.elements){		
		sHTML+="<"+elements.tag+" ";
		for(attr in elements){
			if(attr.toString=="tag") continue;
			sHTML+=attr + "='"+ elements[attr] + "' ";
		}
		sHTML+=">\n";		
	}else if(A.text){
		for(var i=0;i<A.text.length;i++){
			sHTML+="\t\t<li>"+A.text[i]+"</li>\n";
			
		}
	
		
	}else if(A.html){
		sHTML+=A.html;
		
	}
	

	sHTML = "<style>\n\t" + sCSS + "</style>\n<div id=\""+ this.id +"\" class=\"marquee\" onmouseover=\"\">\n\t<ul id=\""+ this.id+"_c\"  style=\"clear:both;list-style:none; border:0px; padding:0px; margin:0px;\">\n" + sHTML + "\n\t</ul>\n</div>"
	
	document.write(sHTML);
	
	
	
	
	var _HtmlL = document.getElementById(this.cid).innerHTML;
	var _HtmlT = document.getElementById(this.id).innerHTML;
	switch (this.direction){
		case "left":
			document.getElementById(this.cid).innerHTML=_HtmlL+_HtmlL;
			break;
		case "right":
			document.getElementById(this.cid).innerHTML=_HtmlL+_HtmlL;
			break;
		case "up":
			document.getElementById(this.id).innerHTML=_HtmlT+_HtmlT;
			break;
		case "down":
			document.getElementById(this.id).innerHTML=_HtmlT+_HtmlT;
			break;
	}
	document.getElementById(this.cid).style.width=this.width*2;
	document.getElementById(this.cid).style.height=this.height;
	this.element=document.getElementById(this.id);
	/*var _marquee={
			id:this.id,
			begin:this.begin,
			stop:this.stop,
			param:this,
			element:document.getElementById(this.id)
	};*/
	this.begin();
	 return this;
}

marquee.stop=function(id){
	if(!id) id = this.id;
	document.getElementById(id).scrollLeft=document.getElementById(this.id).scrollLeft;
	document.getElementById(id).scrollTop=document.getElementById(this.id).scrollTop;
	clearTimeout(marquee.showert);
}


marquee.begin=function(id){	
		if(!id) id = this.id;
		var ele;
		ele=document.getElementById(id);	
		switch (this.direction){
			case "left":
				window.shower=function(id){
					var ele;
					ele=document.getElementById(id);
					ele.style.width=marquee.width;
					ele.style.height=marquee.height;
					ele.scrollLeft=ele.scrollLeft+5;
					if (ele.scrollLeft>=marquee.width){
						ele.scrollLeft=0;
					}
					marquee.showert=setTimeout("window.shower('"+id+"')",marquee.speed);
				};
				
				break;
			case "right":
				window.shower=function(id){
					var ele;
					ele=document.getElementById(id);
					ele.style.width=marquee.width;
					ele.style.height=marquee.height;
					ele.scrollLeft=ele.scrollLeft-5;
					if (ele.scrollLeft<=0){
						ele.scrollLeft=marquee.width;
					}
					marquee.showert=setTimeout("window.shower('"+id+"')",marquee.speed);
				};
				break;
			case "up":
				window.shower=function(id){
					var ele;
					ele=document.getElementById(id);
					ele.style.width=marquee.width;
					ele.style.height=marquee.height;
					ele.scrollTop=ele.scrollTop+5;
					if (ele.scrollTop>=marquee.height){
						ele.scrollTop=0;
					}
					marquee.showert=setTimeout("window.shower('"+id+"')",marquee.speed);
				};
				break;
			case "down":
				window.shower=function(id){
					var ele;
					ele=document.getElementById(id);
					ele.style.width=marquee.width;
					ele.style.height=marquee.height;
					ele.scrollTop=ele.scrollTop-5;
					if (ele.scrollTop<=0){
						ele.scrollTop=marquee.height;
					}
					marquee.showert=setTimeout("window.shower('"+id+"')",marquee.speed);
				};
				break;
		}
		window.shower(this.id);	
	}
	


</script>
</center>
<input id="fh" type="text">
<script type="text/javascript">

af=marquee.creat({id:"div1",
				 direction: "left",
				 img:Array({src:"do1.gif",onclick:"",onmouseover:""},{src:"do.gif",onclick:"",onmouseover:""},{src:"do.gif",onclick:"",onmouseover:""},{src:"do.gif",onclick:"",onmouseover:""},{src:"do.gif",onclick:"",onmouseover:""},{src:"do.gif",onclick:"",onmouseover:""},{src:"do.gif",onclick:"",onmouseover:""},{src:"do.gif",onclick:"",onmouseover:""}),
				 CSS:"background:#aaeeaa;",
				 width:900
				 });



bf=marquee.creat({id:"div2",
				 direction: "left",
				 img:Array({src:"do.gif",onclick:"",onmouseover:""},{src:"do.gif",onclick:"",onmouseover:""},{src:"do.gif",onclick:"",onmouseover:""},{src:"do.gif",onclick:"",onmouseover:""},{src:"do.gif",onclick:"",onmouseover:""},{src:"do.gif",onclick:"",onmouseover:""},{src:"do.gif",onclick:"",onmouseover:""},{src:"do.gif",onclick:"",onmouseover:""}),
				 CSS:"background:#aaeeaa;",
				 width:900
				 });

bf.width=496;
//af.stop();

var af=Array({src:"do.gif",onclick:"",onmouseover:""},{src:"do.gif",onclick:"",onmouseover:""});
</script>

</body>
</html>
